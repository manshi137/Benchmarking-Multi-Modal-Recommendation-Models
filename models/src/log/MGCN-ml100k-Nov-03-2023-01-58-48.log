Fri 03 Nov 2023 01:58:48 INFO ██Server: 	BeeBee-Ate
Fri 03 Nov 2023 01:58:48 INFO ██Dir: 	C:\Users\richi\OneDrive\Documents\col865\COL865-PROJECT\models\src

Fri 03 Nov 2023 01:58:48 INFO 
gpu_id=0
use_gpu=True
seed=[999]
data_path=../data/
inter_splitting_label=x_label
filter_out_cod_start_users=True
is_multimodal_model=True
checkpoint_dir=saved
save_recommended_topk=True
recommend_topk=recommend_topk/
embedding_size=64
weight_decay=0.0
req_training=True
epochs=1000
stopping_step=20
train_batch_size=2048
learner=adam
learning_rate=0.001
learning_rate_scheduler=[0.96, 50]
eval_step=1
training_neg_sample_num=1
use_neg_sampling=True
use_full_sampling=False
NEG_PREFIX=neg__
USER_ID_FIELD=userID
ITEM_ID_FIELD=itemID
TIME_FIELD=timestamp
field_separator=	
metrics=['Recall', 'NDCG', 'Precision', 'MAP']
topk=[5, 10, 20, 50]
valid_metric=Recall@20
eval_batch_size=4096
use_raw_features=False
max_txt_len=32
max_img_size=256
vocab_size=30522
type_vocab_size=2
hidden_size=4
pad_token_id=0
max_position_embeddings=512
layer_norm_eps=1e-12
hidden_dropout_prob=0.1
end2end=False
hyper_parameters=['cl_loss', 'seed']
inter_file_name=ml100k.inter
vision_feature_file=image_feat.npy
text_feature_file=text_feat.npy
user_graph_dict_file=user_graph_dict.npy
n_ui_layers=2
n_layers=1
lambda_coeff=0.9
reg_weight=0.0001
knn_k=10
cl_loss=[0.001, 0.01, 0.1]
model=MGCN
dataset=ml100k
valid_metric_bigger=True
device=cpu


Fri 03 Nov 2023 01:58:48 INFO ml100k
The number of users: 943
Average actions of users: 106.04453870625663
The number of items: 1682
Average actions of items: 59.45303210463734
The number of inters: 100000
The sparsity of the dataset: 93.69533063577546%
Fri 03 Nov 2023 01:58:48 INFO 
====Training====
ml100k
The number of users: 943
Average actions of users: 35.227995758218455
The number of items: 1519
Average actions of items: 21.86965108624095
The number of inters: 33220
The sparsity of the dataset: 97.6808429388928%
Fri 03 Nov 2023 01:58:48 INFO 
====Validation====
ml100k
The number of users: 943
Average actions of users: 35.361611876988334
The number of items: 1520
Average actions of items: 21.938157894736843
The number of inters: 33346
The sparsity of the dataset: 97.6735781659876%
Fri 03 Nov 2023 01:58:48 INFO 
====Testing====
ml100k
The number of users: 943
Average actions of users: 35.45493107104984
The number of items: 1513
Average actions of items: 22.097818902842036
The number of inters: 33434
The sparsity of the dataset: 97.65664698803371%
Fri 03 Nov 2023 01:58:48 INFO 

=================================


Fri 03 Nov 2023 01:58:48 INFO =========1/3: Parameters:['cl_loss', 'seed']=(0.001, 999)=======
Fri 03 Nov 2023 01:58:48 INFO MGCN(
  (user_embedding): Embedding(943, 64)
  (item_id_embedding): Embedding(1682, 64)
  (image_embedding): Embedding(1682, 4096)
  (text_embedding): Embedding(1682, 384)
  (image_trs): Linear(in_features=4096, out_features=64, bias=True)
  (text_trs): Linear(in_features=384, out_features=64, bias=True)
  (softmax): Softmax(dim=-1)
  (query_common): Sequential(
    (0): Linear(in_features=64, out_features=64, bias=True)
    (1): Tanh()
    (2): Linear(in_features=64, out_features=1, bias=False)
  )
  (gate_v): Sequential(
    (0): Linear(in_features=64, out_features=64, bias=True)
    (1): Sigmoid()
  )
  (gate_t): Sequential(
    (0): Linear(in_features=64, out_features=64, bias=True)
    (1): Sigmoid()
  )
  (gate_image_prefer): Sequential(
    (0): Linear(in_features=64, out_features=64, bias=True)
    (1): Sigmoid()
  )
  (gate_text_prefer): Sequential(
    (0): Linear(in_features=64, out_features=64, bias=True)
    (1): Sigmoid()
  )
)
Trainable parameters: 8011072
Fri 03 Nov 2023 01:58:54 INFO epoch 0 training [time: 4.84s, train loss: 11.9593]
Fri 03 Nov 2023 01:58:54 INFO epoch 0 evaluating [time: 0.23s, valid_score: 0.033900]
Fri 03 Nov 2023 01:58:54 INFO valid result: 
recall@5: 0.0124    recall@10: 0.0203    recall@20: 0.0339    recall@50: 0.0686    ndcg@5: 0.0756    ndcg@10: 0.0669    ndcg@20: 0.0632    ndcg@50: 0.0694    precision@5: 0.0704    precision@10: 0.0594    precision@20: 0.0511    precision@50: 0.0440    map@5: 0.0405    map@10: 0.0263    map@20: 0.0188    map@50: 0.0153    
Fri 03 Nov 2023 01:58:54 INFO test result: 
recall@5: 0.0101    recall@10: 0.0191    recall@20: 0.0333    recall@50: 0.0706    ndcg@5: 0.0599    ndcg@10: 0.0597    ndcg@20: 0.0585    ndcg@50: 0.0659    precision@5: 0.0579    precision@10: 0.0569    precision@20: 0.0508    precision@50: 0.0438    map@5: 0.0313    map@10: 0.0222    map@20: 0.0160    map@50: 0.0132    
Fri 03 Nov 2023 01:58:54 INFO ██ MGCN--Best validation results updated!!!
Fri 03 Nov 2023 01:58:59 INFO epoch 1 training [time: 5.34s, train loss: 11.9064]
Fri 03 Nov 2023 01:59:00 INFO epoch 1 evaluating [time: 0.28s, valid_score: 0.073400]
Fri 03 Nov 2023 01:59:00 INFO valid result: 
recall@5: 0.0252    recall@10: 0.0437    recall@20: 0.0734    recall@50: 0.1385    ndcg@5: 0.1424    ndcg@10: 0.1303    ndcg@20: 0.1244    ndcg@50: 0.1339    precision@5: 0.1317    precision@10: 0.1169    precision@20: 0.0996    precision@50: 0.0796    map@5: 0.0849    map@10: 0.0588    map@20: 0.0441    map@50: 0.0377    
Fri 03 Nov 2023 01:59:00 INFO test result: 
recall@5: 0.0238    recall@10: 0.0434    recall@20: 0.0726    recall@50: 0.1396    ndcg@5: 0.1235    ndcg@10: 0.1193    ndcg@20: 0.1180    ndcg@50: 0.1292    precision@5: 0.1183    precision@10: 0.1108    precision@20: 0.0985    precision@50: 0.0783    map@5: 0.0701    map@10: 0.0515    map@20: 0.0402    map@50: 0.0347    
Fri 03 Nov 2023 01:59:00 INFO ██ MGCN--Best validation results updated!!!
Fri 03 Nov 2023 01:59:05 INFO epoch 2 training [time: 5.39s, train loss: 11.8723]
Fri 03 Nov 2023 01:59:06 INFO epoch 2 evaluating [time: 0.25s, valid_score: 0.124100]
Fri 03 Nov 2023 01:59:06 INFO valid result: 
recall@5: 0.0404    recall@10: 0.0720    recall@20: 0.1241    recall@50: 0.2360    ndcg@5: 0.2136    ndcg@10: 0.2011    ndcg@20: 0.1974    ndcg@50: 0.2176    precision@5: 0.2040    precision@10: 0.1854    precision@20: 0.1618    precision@50: 0.1293    map@5: 0.1335    map@10: 0.1002    map@20: 0.0811    map@50: 0.0739    
Fri 03 Nov 2023 01:59:06 INFO test result: 
recall@5: 0.0401    recall@10: 0.0723    recall@20: 0.1284    recall@50: 0.2426    ndcg@5: 0.1975    ndcg@10: 0.1890    ndcg@20: 0.1929    ndcg@50: 0.2176    precision@5: 0.1941    precision@10: 0.1777    precision@20: 0.1615    precision@50: 0.1312    map@5: 0.1198    map@10: 0.0911    map@20: 0.0766    map@50: 0.0727    
Fri 03 Nov 2023 01:59:06 INFO ██ MGCN--Best validation results updated!!!
Fri 03 Nov 2023 01:59:11 INFO epoch 3 training [time: 5.59s, train loss: 11.8236]
Fri 03 Nov 2023 01:59:12 INFO epoch 3 evaluating [time: 0.26s, valid_score: 0.164100]
Fri 03 Nov 2023 01:59:12 INFO valid result: 
recall@5: 0.0523    recall@10: 0.0914    recall@20: 0.1641    recall@50: 0.3079    ndcg@5: 0.2637    ndcg@10: 0.2463    ndcg@20: 0.2471    ndcg@50: 0.2777    precision@5: 0.2554    precision@10: 0.2276    precision@20: 0.2028    precision@50: 0.1640    map@5: 0.1719    map@10: 0.1307    map@20: 0.1089    map@50: 0.1039    
Fri 03 Nov 2023 01:59:12 INFO test result: 
recall@5: 0.0527    recall@10: 0.0948    recall@20: 0.1658    recall@50: 0.3140    ndcg@5: 0.2510    ndcg@10: 0.2415    ndcg@20: 0.2464    ndcg@50: 0.2813    precision@5: 0.2431    precision@10: 0.2259    precision@20: 0.2046    precision@50: 0.1676    map@5: 0.1603    map@10: 0.1251    map@20: 0.1080    map@50: 0.1062    
Fri 03 Nov 2023 01:59:12 INFO ██ MGCN--Best validation results updated!!!
Fri 03 Nov 2023 01:59:17 INFO epoch 4 training [time: 5.32s, train loss: 11.7003]
Fri 03 Nov 2023 01:59:18 INFO epoch 4 evaluating [time: 0.24s, valid_score: 0.180400]
Fri 03 Nov 2023 01:59:18 INFO valid result: 
recall@5: 0.0589    recall@10: 0.1042    recall@20: 0.1804    recall@50: 0.3355    ndcg@5: 0.2836    ndcg@10: 0.2678    ndcg@20: 0.2685    ndcg@50: 0.3033    precision@5: 0.2723    precision@10: 0.2461    precision@20: 0.2180    precision@50: 0.1759    map@5: 0.1859    map@10: 0.1428    map@20: 0.1209    map@50: 0.1181    
Fri 03 Nov 2023 01:59:18 INFO test result: 
recall@5: 0.0585    recall@10: 0.1051    recall@20: 0.1793    recall@50: 0.3373    ndcg@5: 0.2783    ndcg@10: 0.2655    ndcg@20: 0.2681    ndcg@50: 0.3042    precision@5: 0.2698    precision@10: 0.2473    precision@20: 0.2205    precision@50: 0.1778    map@5: 0.1840    map@10: 0.1436    map@20: 0.1228    map@50: 0.1207    
Fri 03 Nov 2023 01:59:18 INFO ██ MGCN--Best validation results updated!!!
